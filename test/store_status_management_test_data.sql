-- 店面状态管理功能测试数据
-- 用于测试店面状态变更申请和审批流程

-- 清理可能存在的测试数据
DELETE FROM RENT_STORE WHERE STORE_ID IN (3001, 3002, 3003);
DELETE FROM STORE WHERE STORE_ID IN (3001, 3002, 3003);
DELETE FROM RETAIL_AREA WHERE AREA_ID IN (2001, 2002, 2003);
DELETE FROM AREA WHERE AREA_ID IN (2001, 2002, 2003);
COMMIT;

-- 创建测试用的区域数据
INSERT INTO AREA (AREA_ID, ISEMPTY, AREA_SIZE, CATEGORY) VALUES (2001, 0, 60, 'RETAIL');  -- 已占用
INSERT INTO AREA (AREA_ID, ISEMPTY, AREA_SIZE, CATEGORY) VALUES (2002, 0, 90, 'RETAIL');  -- 已占用
INSERT INTO AREA (AREA_ID, ISEMPTY, AREA_SIZE, CATEGORY) VALUES (2003, 0, 150, 'EVENT'); -- 已占用

INSERT INTO RETAIL_AREA (AREA_ID, RENT_STATUS, BASE_RENT) VALUES (2001, '已租用', 6000.00);
INSERT INTO RETAIL_AREA (AREA_ID, RENT_STATUS, BASE_RENT) VALUES (2002, '已租用', 9000.00);
INSERT INTO RETAIL_AREA (AREA_ID, RENT_STATUS, BASE_RENT) VALUES (2003, '已租用', 15000.00);

-- 创建测试店铺数据（不同状态用于测试）
INSERT INTO STORE (STORE_ID, STORE_NAME, STORE_STATUS, STORE_TYPE, TENANT_NAME, CONTACT_INFO, RENT_START, RENT_END) 
VALUES (3001, '麦当劳餐厅', '正常营业', '企业连锁', '麦当劳中国', '13900139001', DATE '2024-01-15', DATE '2026-01-14');

INSERT INTO STORE (STORE_ID, STORE_NAME, STORE_STATUS, STORE_TYPE, TENANT_NAME, CONTACT_INFO, RENT_START, RENT_END) 
VALUES (3002, '小米专卖店', '正常营业', '企业连锁', '小米科技', '13900139002', DATE '2024-02-01', DATE '2025-01-31');

INSERT INTO STORE (STORE_ID, STORE_NAME, STORE_STATUS, STORE_TYPE, TENANT_NAME, CONTACT_INFO, RENT_START, RENT_END) 
VALUES (3003, '周大福珠宝', '正常营业', '企业连锁', '周大福集团', '13900139003', DATE '2024-03-01', DATE '2027-02-28');

-- 创建租赁关系（确保有有效租用记录）
INSERT INTO RENT_STORE (STORE_ID, AREA_ID) VALUES (3001, 2001);
INSERT INTO RENT_STORE (STORE_ID, AREA_ID) VALUES (3002, 2002);
INSERT INTO RENT_STORE (STORE_ID, AREA_ID) VALUES (3003, 2003);

COMMIT;

-- 验证测试数据
SELECT '店铺信息' as INFO, s.STORE_ID, s.STORE_NAME, s.STORE_STATUS, s.TENANT_NAME
FROM STORE s 
WHERE s.STORE_ID IN (3001, 3002, 3003)
ORDER BY s.STORE_ID;

SELECT '租赁关系' as INFO, rs.STORE_ID, rs.AREA_ID, s.STORE_NAME, a.AREA_SIZE
FROM RENT_STORE rs
JOIN STORE s ON rs.STORE_ID = s.STORE_ID
JOIN AREA a ON rs.AREA_ID = a.AREA_ID
WHERE rs.STORE_ID IN (3001, 3002, 3003)
ORDER BY rs.STORE_ID;

PROMPT '店面状态管理测试数据创建完成！'
PROMPT '测试场景：'
PROMPT '- 店铺3001 (麦当劳餐厅): 正常营业状态，可申请状态变更'
PROMPT '- 店铺3002 (小米专卖店): 正常营业状态，可申请状态变更'
PROMPT '- 店铺3003 (周大福珠宝): 正常营业状态，可申请状态变更'
PROMPT '所有店铺都有有效租用记录，满足申请前置条件'

-- 管理员账号
INSERT INTO ACCOUNT (ACCOUNT, PASSWORD, USERNAME, IDENTITY, AUTHORITY) VALUES ('admin', 'adminpass', '系统管理员', '员工', 1);
INSERT INTO ACCOUNT (ACCOUNT, PASSWORD, USERNAME, IDENTITY, AUTHORITY) VALUES ('admin_test', 'admintest', '测试管理员', '员工', 1);

-- 前端默认申请人 merchant001，关联到店铺3001
-- 已移除旧的 merchant001，使用系统生成的 store_003001 等账号作为商户账号映射

-- 与店铺 3001/3002/3003 对应的系统生成商户账号（用于兼容已有测试逻辑）
INSERT INTO ACCOUNT (ACCOUNT, PASSWORD, USERNAME, IDENTITY, AUTHORITY) VALUES ('store_003001', 'initpass1', '麦当劳中国', '商户', 4);
INSERT INTO ACCOUNT (ACCOUNT, PASSWORD, USERNAME, IDENTITY, AUTHORITY) VALUES ('store_003002', 'initpass2', '小米科技', '商户', 4);
INSERT INTO ACCOUNT (ACCOUNT, PASSWORD, USERNAME, IDENTITY, AUTHORITY) VALUES ('store_003003', 'initpass3', '周大福集团', '商户', 4);

INSERT INTO STORE_ACCOUNT (ACCOUNT, STORE_ID) VALUES ('store_003001', 3001);
INSERT INTO STORE_ACCOUNT (ACCOUNT, STORE_ID) VALUES ('store_003002', 3002);
INSERT INTO STORE_ACCOUNT (ACCOUNT, STORE_ID) VALUES ('store_003003', 3003);

COMMIT;